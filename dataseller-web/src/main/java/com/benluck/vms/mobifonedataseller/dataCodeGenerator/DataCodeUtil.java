package com.benluck.vms.mobifonedataseller.dataCodeGenerator;

import com.benluck.vms.mobifonedataseller.common.Constants;
import com.benluck.vms.mobifonedataseller.common.utils.Config;
import com.benluck.vms.mobifonedataseller.context.AppContext;
import com.benluck.vms.mobifonedataseller.redis.domain.DataCode;
import com.benluck.vms.mobifonedataseller.redis.service.DataCodeService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.data.redis.core.RedisTemplate;

import java.util.*;

/**
 * Created with IntelliJ IDEA.
 * User: vietquocpham
 * Date: 11/5/16
 * Time: 22:35
 * To change this template use File | Settings | File Templates.
 */
public class DataCodeUtil {
    private static boolean showCounter = true;
    private static StringBuilder dataCodeSuffix = null;
    private static StringBuilder prefixDataCode = null;
    private static StringBuilder tmpDataCode = null;
    private static List<String> duplicatedList = null;
    private static int min = 1;
    private static int max = 9999999;
    private static int total_length = 12;
    private static int prefix_year = 3;
    private static int prefix_unit_price = 2;

    @Autowired
    private static DataCodeService dataCodeService;

    public static DataCode generateDataCodes(String yearCode, String unitPriceCode, Integer numberOfDataCodes){
        DataCode dataCode = new DataCode(yearCode, unitPriceCode);
        dataCode.setDataCodeHashSet(generateDataCodeList(yearCode, (unitPriceCode.length() == 1 ? "0" + unitPriceCode : unitPriceCode), numberOfDataCodes));
        return dataCode;
    }

    public static HashSet<String> getUsedDataCodeHashSet(){
        String[] usedDataCodeArr = {"216106906334","216100905580","216106634735","216102700661","216104836547","216108356524","216104005131","216101895825","216103226420","216107528933","216109387647","216106898102","216105202457","216103548370","216108155526","216104359731","216104161302","216106996679","216108005190","216103924028","216103413634","216102236291","216106521829","216107099372","216102559185","216102067240","216100569617","216109995367","216109747307","216100496419","216106581091","216105871408","216109461438","216106372209","216108557751","216102237776","216102121678","216104632188","216109945101","216104286547","216104299422","216101056186","216105673478","216104625450","216105577131","216104364930","216107172904","216108989269","216109180972","216107897909","216108723369","216109693246","216107161837","216106768734","216105353232","216109117784","216104293967","216109001796","216105338509","216105117767","216102441308","216103964747","216102077503","216101083472","216103355465","216103519094","216100716374","216104110782","216108250191","216107034284","216106420080","216109409461","216105214555","216101956244","216101225623","216105046247","216100880811","216107213321","216101873759","216103347084","216108976158","216101514599","216109353610","216102370096","216108321627","216101604237","216109313127","216104885053","216104570547","216105015306","216103618845","216100195263","216107135290","216106445146","216109143113","216104190661","216107056651","216106019993","216109296520","216108614383","216107051348","216105393434","216101193809","216100924238","216102293366","216106563307","216107508565","216103848302","216105036819","216109890377","216104749200","216105441633","216108267234","216107038501","216104024746","216106299190","216108918553","216104037132","216102703562","216105993016","216100589366","216100388920","216103586099","216100457459","216108885449","216104900262","216102337471","216105093411","216106506657","216107747630","216105250115","216104348565","216105842650","216108887293","216108221775","216106178060","216105571724","216107045217","216102367258","216105319273","216100116704","216103535012","216100476731","216105161344","216105442681","216109822392","216102235808","216108090078","216104484702","216101088829","216109099578","216100823438","216103244186","216106166184","216105921731","216100978919","216104696716","216100924783","216102756606","216103488641","216105551566","216100424128","216108923069","216109180047","216100123711","216104019161","216106788197","216103832887","216107983345","216109080856","216107753393","216109342029","216107070155","216104994787","216101148354","216107279504","216103700568","216106738327","216100560487","216102887640","216102286799","216101226269","216105374183","216105458339","216107335542","216102870774","216105660055","216106279141","216104944235","216102720656","216108764934","216107608898","216102654460","216101513277","216105843601","216102923715","216104587062","216109591202","216104958119","216109716860","216106821405","216101682495","216109985958","216103175089","216102916364","216103552486","216107749576","216104809866","216103807513","216104003272","216103509941","216100624217","216104095476","216100405036","216101435914","216104226777","216106394642","216107398959","216107985439","216103246917","216108707173","216109475939","216102213943","216101703540","216100950144","216104631094","216104372927","216108199465","216105203036","216107261264","216104819771","216102669588","216107761903","216103962186","216102635052","216109529802","216103635834","216102964736","216106222265","216106882917","216105689079","216101644526","216101021497","216104425130","216108725101","216108806847","216109561634","216100843053","216106191925","216100203855","216107867572","216100304306","216104835538","216107191454","216107913872","216109937159","216103913641","216107494274","216100684642","216109966597","216105213397","216102789974","216106327060","216109441540","216108757585","216103756249","216106459173","216104228263","216102366503","216107337799","216109739870","216100648561","216105288350","216103821292","216108122544","216104128293","216103167898","216103585824","216108369109","216107437262","216102181365","216106806011","216101382882","216102865022","216109701260","216100430398","216100913720","216100971001","216103666348","216104629667","216102771164","216104289829","216107896231","216108461182","216101729473","216101302224","216108811098","216107047375","216107468970","216103649242","216109190517","216100064839","216106231869","216106491626","216109026991","216105645774","216104733994","216105032263","216103482430","216108374448","216106335614","216102023826","216106710052","216104246114","216100098785","216102883089","216103130652","216105209002","216109149146","216100713768","216109776400","216107977133","216107552426","216104083058","216100419708","216107338369","216103300824","216101557657","216109815108","216107662028","216108340441","216105425867","216100996181","216108134097","216107133184","216108206345","216109353374","216108896996","216104056779","216109596529","216101158294","216102978798","216100706968","216105802073","216101857822","216103236342","216106077015","216106352127","216103223484","216100577681","216104516610","216104152267","216100056608","216101067544","216105214082","216105104648","216109636705","216105683529","216105403584","216107651812","216101213679","216108238364","216103456186","216102604018","216101713167","216109671276","216104337590","216106398668","216109843728","216103871809","216100078374","216104595887","216106473837","216103219385","216101944845","216109110758","216100765643","216103025511","216107049744","216109873326","216109620711","216107487831","216102430185","216107075415","216106631042","216106538805","216109341772","216109553809","216104861652","216100115007","216101502195","216102500631","216102993216","216104440119","216100726000","216105488379","216104996049","216103610629","216109536660","216108527465","216108015201","216105355863","216109897039","216109972033","216107376213","216102433435","216104658540","216102770816","216108612607","216109215301","216104502555","216104054599","216107965807","216101232420","216104940134","216109611740","216106620931","216101728614","216100100739","216103139705","216104982079","216107209214","216108286725","216101707253","216101224197","216107117222","216108507481","216100214747","216108894287","216108778049","216101268797","216102988253","216100945008","216101342644","216107673401","216104620135","216103066348","216102191125","216107760843","216104399011","216108486491","216102527283","216106621726","216103961086","216108798832","216102835078","216104795367","216105221536","216101600916","216106795368","216105926413","216108427168","216100890968","216101439978","216107921592","216107276854","216102317986","216101910302","216104305133","216109380390","216104217369","216109874703","216103939054","216109267139","216103970595","216102327070","216100676821","216108141460","216100013298","216108143757","216105046773","216102243490","216100536031","216102856166","216105679206","216100084225","216106160000","216101955213","216101862463","216104818224","216100788585","216104654668","216104908764","216105568689","216106922889","216103487153","216104968576","216103095851","216108201234","216104711636","216107446663","216109203767","216101623185","216105203778","216102348881","216100183466","216101073941","216100306104","216109652263","216105729646","216101506999","216105599192","216107840154","216100569925","216102520632","216101322072","216102545983","216100999692","216107104789","216100238395","216102701567","216100850909","216104770235","216102173220","216105522517","216102410730","216105438152","216101580639","216105498746","216105201024","216100786011","216102493667","216101159149","216104319993","216107558448","216107951890","216105833610","216108946654","216104322504","216108901234","216108804389","216106416880","216102120297","216109522187","216101070065","216104288348","216109574527","216104011661","216101462178","216107359601","216109465557","216108261370","216105178773","216109827226","216107105132","216101244902","216101023318","216104470570","216107234859","216107169849","216108803827","216100709509","216107321540","216103054176","216106239967","216101212421","216106662543","216104029152","216101348179","216105213970","216100456332","216100299381","216108936369","216101604795","216100017876","216108983024","216101647460","216102883554","216104492418","216105534417","216107061419","216106154323","216109834658","216104497144","216108503650","216108206448","216108209283","216109225100","216107101110","216103359729","216109439683","216109737923","216109055986","216100537402","216103765819","216104175980","216107779749","216109373865","216107293378","216105998855","216108617069","216106136476","216108180073","216100917062","216109260555","216105310529","216109059358","216101273567","216107934687","216102151192","216109297169","216100678457","216106178665","216109714257","216103750885","216104524379","216101780710","216107411772","216108813652","216106803820","216105889737","216108964832","216104539953","216100973104","216105123315","216106430738","216107156516","216103336687","216107646490","216108970370","216109084502","216109415023","216104807165","216107774356","216108744324","216106089517","216107032680","216106667067","216104014947","216104071369","216108427666","216101643697","216100146298","216108321763","216107115667","216109854235","216108015657","216109956508","216102975813","216103851793","216108387921","216101448463","216103198591","216104685480","216105444713","216106674916","216103758102","216109001741","216105085296","216101312025","216106628124","216108253101","216100970176","216103387290","216109492595","216106177849","216103601305","216109276379","216103485244","216102946803","216106946477","216100577316","216105893870","216101284768","216108761443","216102928374","216108642259","216108733360","216109185990","216100943622","216109725364","216107444638","216100579683","216100864436","216103694859","216103815612","216103937386","216105336717","216100867950","216104077412","216108265032","216105150981","216100385864","216107980546","216103512427","216109269729","216102466381","216101902771","216106071265","216109258988","216101965179","216107172355","216108396124","216107631352","216104980515","216103366550","216105311317","216103682239","216102391599","216105966154","216108877911","216105612469","216108050213","216103299095","216107970448","216106277987","216100557438","216102128693","216109937165","216102692071","216107934554","216108753467","216102772142","216105834785","216106728733","216108282344","216108996099","216100159060","216109890117","216108990322","216103104221","216109751789","216102624987","216106949611","216104800602","216106636588","216105251863","216105870878","216106189468","216102596716","216109601489","216102911384","216108535032","216108258618","216103712762","216106853191","216104052485","216106500852","216104519459","216100187614","216100298237","216108412886","216102153566","216105777983","216101974876","216102535751","216106877475","216102860173","216109335719","216105456926","216101486955","216100111979","216107803712","216100669611","216105770927","216103977671","216106408314","216102339844","216100099892","216103325403","216100800249","216108758372","216101322052","216100305019","216109590431","216102314662","216101265976","216107707378","216101349949","216104858196","216105928804","216108216763","216109013462","216100044174","216100356183","216103037257","216104623397","216107757058","216104811076","216105228902","216103735833","216103390921","216108314498","216101893892","216106612702","216101823500","216103160274","216106584780","216101972256","216103378665","216102872483","216106173445","216107053315","216105245881","216107958921","216102537255","216105341747","216107240005","216104084983","216107413495","216107415580","216107512475","216109109372","216101233103","216108904615","216109301575","216102086543","216101914496","216107736199","216100966055","216101571372","216101134923","216103125631","216109865119","216103884309","216104395463","216102371065","216107847316","216105558553","216104303035","216108047554","216103189437","216106742630","216104917629","216100105331","216104726678","216109660740","216100270039","216106701533","216104805776","216108617403","216107630397","216105341245","216101517669","216104116310","216106654516","216109230846","216103379845","216100006196","216107124727","216103120081","216104504923","216105736520","216108877903","216102543394","216100428400","216105370964","216101505331","216106039187","216109741857","216104698966","216107199278","216109158065","216100097532","216106606707","216106916701","216102320106","216100733325","216108277830","216101632790","216105927383","216108431231","216107853537","216105009470","216109828225","216100298559","216103129646","216106433548","216108592928","216102520749","216105743292","216101977617","216105468969","216108483610","216106132394","216100841721","216100925431","216103556284","216107399223","216106752129","216106564094","216103370165","216100933381","216107485426","216101193497","216106442747","216101496850","216105172308","216103385978","216109686841","216105448451","216109000989","216109131923","216105949261","216107965338","216102353102","216106914555","216102507230","216107792838","216105041802","216104267812","216109697189","216108357000","216100281086","216108163974","216106852428","216106873711","216101833833","216108984211","216106215063","216106023683","216104358018","216107605540","216105782972","216107669673","216100763399","216108146158","216105991017","216106768270","216107162382","216102459990","216106720222","216105371117","216108535665","216104982768","216108351725","216100908992","216101537766","216100563800","216109526661","216100552559","216109369885","216103077841","216103861417","216105330000","216107281076","216102373065","216102763550","216108429258","216103956518","216102120677","216104820899","216102165548","216102219497","216106873270","216107906744","216100129730","216101227826","216106251739","216103221657","216104391552","216106291890","216101583799","216108222836","216107783672","216104753874","216102672527","216102379932","216109409342","216103844086","216102586474","216106762037","216105112395","216108225048","216103744900","216103342142","216103244451","216109840422","216109680968","216100025378","216106612531","216100875346","216103100387","216104219428","216108611776","216106069792","216100623736","216103592178","216108458112","216102192741","216108024220","216106415572","216102917636","216103670299","216102906055","216106234427","216100697671","216107249457","216108913257","216105618744","216109974573","216107451516","216104414025","216108387388","216100236268","216101701378","216109497346","216108035519","216101503930","216103563024","216106576243","216107231708","216106859599","216102483229","216101498263","216108389600","216104609715","216103760632","216103847122","216109251984","216108718376","216100483107","216109493064","216105819192","216104731790","216104080053","216104932211","216106866097","216100865459","216105823613","216105779056","216107970987","216101895818","216106131486","216103468822","216102744081","216106128389","216107067079","216106114692","216109794511","216109864867","216101485554","216102307907","216101881779","216109611973","216105024943","216109158535","216109186201","216102964683","216100397599","216109138000","216102115794","216107729471","216109988692","216103867926","216106825330","216105989924","216102846736","216106328397","216105490750","216104043701","216104442519","216102427454","216102160298","216104277662","216100767709","216108642500","216109996717","216103803457","216103252696","216100892169","216100445503","216100005815","216107588945","216100599644","216102158230","216106886009","216109130922","216102079260","216100638183","216109376312","216106852354","216109190838","216102755014","216108815827","216105102974","216101996840","216108366859","216103879607","216103397819","216104635458","216103987695","216105538224","216109007829","216107252856","216102752165","216103678763","216103055129","216106017999","216108149522","216109597000","216107119514","216107812942","216106949660","216105552955","216100314655","216106846071","216105793632","216104056691","216107375540","216107804780","216101381076","216100600316","216107398480","216106946365","216106280743","216104221914","216104463765","216107172220","216104331335","216104550056","216103959326","216103085200","216109923052","216104869891","216109186609","216101601671","216103297951","216105332033","216102909703","216100566811","216104128114","216107618696","216107047081","216100395687","216102790508","216104360793","216101404530","216109302356","216107247854","216103792613","216100438982","216104203695","216106437178","216104378682","216103023868","216102310124","216105472039","216100519158","216107567481","216103384876","216108611268","216109630721","216107832655","216101614392","216100650879","216102011058","216108041104","216101793930","216103965807","216102825082","216103361748","216100358186","216103768245","216102105139","216101780436","216106759460","216102904115","216108472944","216101062322","216101219277","216102451558","216106857205","216101869356","216101623294","216106858762","216100337555","216101308709","216102068993","216105963133","216104525832","216105342980","216100716355","216103901251","216107459269","216106831020","216106482123","216109038886","216102969719","216109983285","216102998245","216103551483","216106914693","216107894016","216100496734","216105262419","216100285995","216102548646","216102199646","216104194883","216104575524","216106120022","216106718066","216102313422","216104451349","216101819939","216102654789","216101484977","216101066614","216102391490","216106779325","216107388143","216106659419","216106837127","216102975845","216104095025","216109356695","216104166259","216100849674","216108869539","216106080359","216108732916","216103278358","216105858052","216105793487","216102932322","216102296940","216106906466","216105457022","216105253638","216100991674","216102083412","216103475981","216103747350","216106567748","216102389496","216104623481","216108820861","216103261766","216104383380","216109758549","216109903732","216107843046","216108789147","216108068486","216105382218","216108867740","216100209774","216108096030","216109609795","216104079276","216103851494","216107982748","216103800201","216106562608","216109107934","216105188594","216104764169","216105057038","216107329482","216108517101","216109256263","216109496794","216108566925","216101555734","216102077172","216109433415","216105328497","216106265392","216102055678","216103024494","216106060201","216106693396","216108161050","216100000846","216103589647","216109254295","216101361802","216105304374","216104744358","216107836242","216100179786","216102652139","216108553788","216106650962","216108471955","216109992108","216108004250","216104194529","216105815687","216102744528","216108573305","216104574135","216103190916","216106880617","216100302678","216103211568","216105405269","216105855728","216100261225","216103549344","216106082669","216108395921","216109084270","216100101736","216106330760","216106666976","216106384155","216106184497","216109057670","216108016671","216104868662","216105557843","216106638783","216106316685","216102828330","216103781137","216105797078","216109971128","216108838800","216107725132","216103370220","216107073313","216101843780","216107898427","216100460770","216102150754","216105621928","216105263957","216107782121","216106897632","216107406990","216102298267","216107959724","216108269936","216108666468","216101060093","216105800655","216105730934","216106148836","216106088907","216109924061","216109828721","216108675011","216105766758","216103286721","216106049126","216104382408","216104962706","216100800040","216102032063","216106264960","216107856445","216105322139","216102866853","216104783161","216106629964","216103592545","216108909146","216105327560","216109020525","216101000378","216100119114","216103448641","216104583238","216102256152","216109414201","216101687089","216101361244","216105901461","216109265560","216105227984","216105639010","216109112183","216102915957","216108033384","216100989413","216109696952","216105747549","216100245080","216108396710","216100103981","216101841641","216100145661","216107139016","216103228739","216100880812","216101182402","216103667149","216104764061","216106201701","216101104403","216108088061","216100554513","216108060404","216103570924","216103271553","216109985100","216109774578","216100090743","216106505660","216105883287","216106580191","216106288137","216108329637","216106481442","216108048907","216103525620","216106051296","216109493123","216108452531","216106156713","216104028647","216102373542","216102826637","216104800432","216106024097","216108927189","216103690937","216100608979","216103258587","216109416010","216100162928","216107466423","216103756860","216107107353","216106005151","216105021385","216102435025","216101247357","216101755631","216106293288","216106343463","216105132674","216100944042","216105642233","216105203362","216105987893","216102349615","216107207798","216102071536","216106656165","216103854007","216105507252","216103784552","216100042207","216104090277","216100086055","216108925108","216107921855","216104997861","216105919660","216101101445","216101636897","216100320433","216105010129","216106974469","216101042186","216108656703","216103611327","216100365909","216103834973","216107787267","216106639425","216100659079","216102252243","216101156017","216105780359","216108722701","216102291139","216103104306","216101645991","216108679469","216102184295","216101191327","216108225449","216107731800","216107068396","216101519170","216105387703","216108552781","216106454385","216104681061","216102305760","216106623235","216105628121","216103939664","216102292147","216108801053","216109140343","216104983334","216108308340","216105302131","216106856508","216100040128","216108620727","216109937234","216101213831","216108014663","216106814224","216107007539","216104189983","216105638578","216100897402","216101647084","216108377130","216107381013","216108858711","216104531008","216101920564","216108006684","216101684003","216104001041","216108672923","216106948365","216107587538","216107396919","216106290281","216102995802","216102324273","216107630761","216108465495","216101489178","216103438518","216103243694","216102104398","216104081781","216103490062","216107453304","216107999944","216108206003","216106324810","216102125919","216107566831","216102210197","216105882226","216107376746","216101531212","216105544526","216105908807","216107597202","216101297809","216104445991","216107568130","216100333741","216108854125","216108683064","216103782498","216109645164","216103946179","216109009666","216102485075","216103462527","216101188043","216100947499","216104489262","216100559306","216103150436","216101500363","216109395247","216100739811","216108287068","216101106575","216105313100","216109023352","216102646327","216100461879","216102464007","216107681875","216108405969","216104436555","216105269696","216102088739","216107836272","216109385948","216103644672","216105835896","216107835467","216100472468","216104914940","216107492564","216103447395","216103558843","216106963671","216102955217","216104466492","216106839818","216101965354","216105038103","216108634994","216105247757","216107514238","216105552097","216101136532","216106231397","216102875198","216105548008","216102785361","216103086214","216105413866","216102242539","216107961118","216104227289","216103985407","216100551479","216103764528","216107008485","216101382053","216109296935","216109394446","216108348024","216102717964","216101631329","216105535881","216108608009","216104697428","216109657579","216103980574","216104097025","216109542724","216108194225","216104722497","216105481279","216102423738","216100919339","216104200958","216109219373","216109114715","216103098565","216107758572","216106420485","216102806167","216104321525","216108846082","216100810559","216102531956","216103293378","216107832273","216107947633","216100695733","216107124606","216108322123","216102503558","216104437349","216103247273","216108090963","216107274456","216100687544","216105025027","216104971992","216106281343","216100990379","216108317443","216100007490","216105186281","216100433059","216107658554","216102877175","216106001844","216107147476","216100185740","216104517567","216102117995","216109952188","216106590190","216104990839","216107418008","216107192383","216101883298","216100442682","216101073801","216101535936","216104308440","216106567609","216103557744","216104354231","216106629332","216106365714","216109048086","216100858700","216109069275","216101971641","216106762233","216107729930","216105804262","216101725082","216100083791","216103111419","216100000380","216109089460","216100499795","216104176187","216100858557","216101496793","216103755633","216101803801","216107664137","216108801296","216101453244","216104841893","216106416686","216101084281","216100109424","216103661496","216102884897","216101357296","216101069872","216101233277","216100198435","216107692045","216109779066","216103129089","216108608612","216100606260","216106264645","216102823162","216102040863","216105433229","216100375075","216102030341","216106747035","216106895426","216107776118","216101131881","216102539538","216102927436","216109090233","216105655812","216109480093","216109905817","216107050298","216107010917","216101490874","216106069748","216108129165","216101916022","216106588741","216103612117","216104933202","216108076472","216103740794","216109095033","216108186394","216102435149","216109025753","216103292221","216108603082","216107761025","216103669274","216106959600","216108133299","216104739008","216104955383","216109646483","216104861919","216106411377","216103927246","216107072633","216103829945","216104863981","216104649367","216100450603","216101522744","216101367800","216104717063","216104409781","216106301563","216101046559","216104947409","216107152801","216108980734","216109999613","216105037572","216107012931","216109750691","216106171884","216100408065","216102554640","216107187753","216105404346","216103970981","216104155219","216105582925","216103510560","216108817786","216108265368","216101316089","216101425774","216109292048","216104976814","216105961879","216109845540","216105252359","216106030073","216104337055","216109093777","216106205432","216105630941","216108313130","216106243064","216101694264","216100974760","216104015777","216104131836","216100359326","216103255935","216103119889","216105565498","216109890506","216102350625","216106852762","216107015921","216104278494","216108982433","216100417570","216105336141","216101854608","216108124550","216102700844","216109647829","216107672661","216103517648","216109383507","216100214383","216103056938","216105079202","216105103101","216104234107","216104154275","216109465363","216103003364","216108684019","216106944668","216105654117","216103492780","216104137064","216109424060","216101983177","216102669373","216105251009","216106763844","216104916955","216104106864","216104667439","216105049702","216106729558","216108112028","216107639303","216102243255","216101871865","216105078813","216101481912","216106507141","216102252041","216109778763","216106951504","216102542888","216103732010","216104328277","216101213330","216105139982","216101283461","216105714528","216104004978","216105338859","216101557751","216101278097","216106822286","216109368705","216105967103","216107176602","216106579547","216106661628","216100953869","216101124541","216107391406","216104876340","216100855382","216102514017","216103734910","216103147015","216104068637","216104270548","216101698491","216109008150","216105127790","216107869616","216104350602","216108871308","216109838526","216109936304","216103386921","216100007439","216105821464","216103226210","216107787929","216100433388","216104458782","216108069302","216102611322","216101327489","216109160624","216103342962","216101905200","216109316701","216100939592","216101214241","216107191668","216107605649","216105687733","216107394209","216101650530","216102944186","216105236428","216107773506","216107967468","216102448504","216104861482","216103620168","216108572286","216100279542","216104900045","216105926819","216105003957","216102716277","216103805723","216101710421","216100769667","216104702435","216108434668","216102996403","216109713635","216105004365","216101241759","216105036240","216107962613","216103162599","216100953405","216103818016","216108992325","216104259993","216109880657","216100013594","216104363907","216103555846","216103317185","216105633405","216103375945","216106082922","216109570156","216105132384","216101753048","216108705748","216107999992","216101940336","216107335662","216105961021","216105615385","216102774768","216102912660","216105439465","216100237719","216109448298","216105604534","216101316188","216100264629","216108305714","216108675774","216101738921","216103101889","216100718391","216102353353","216101015586","216109933354","216101842204","216107376556","216107687294","216105940665","216107199774","216102245458","216106320844","216103606374","216102754768","216109286524","216106488058","216102406998","216103124875","216108115992","216108175624","216109057292","216100162971","216107289047","216106815052","216104666871","216101822312","216100164091","216107610390","216100087797","216106144264","216107825676","216109976992","216102837848","216106077445","216103142555","216102752522","216101625818","216106451935","216107521794","216103210552","216107127788","216101071483","216102672414","216100485995","216109218021","216102465515","216104663661","216105380607","216108598511","216107060420","216105884213","216104582757","216106552279","216104741296","216107413613","216103187119","216104496040","216107375969","216101450732","216108718485","216106188495","216102470225","216102726009","216106676262","216104919248","216101428430","216101180313","216101747761","216100394632","216106283888","216106051240","216103520683","216100167777","216107607733","216104351949","216102576828","216105966522","216101299623","216106035036","216106787227","216109868137","216101768901","216107905072","216108366230","216105508889","216102714439","216106846103","216101954650","216102342781","216106042252","216105490247","216100101741","216101998428","216109786190","216104594527","216102286664","216102661289","216102610654","216101698963","216101162430","216100060241","216109550041","216102279250","216106734036","216105715829","216108817696","216105913179","216103106809","216100198895","216106006866","216107092608","216102055671","216108995732","216101258998","216102439250","216109103563","216107150908","216106234324","216106085307","216102260734","216101406337","216109124858","216105265334","216108447453","216102220835","216107306413","216107139838","216106310665","216100478500","216107686593","216104787267","216100728859","216103200131","216109561977","216105103666","216106505148","216101915672","216100235520","216106871177","216104698111","216103712852","216109841185","216104660524","216100865805","216108538133","216107476746","216109654958","216107459062","216101843534","216105118898","216101196947","216109492702","216108894170","216108764765","216108933386","216103917280","216108504371","216107639689","216104610593","216101157363","216104865619","216105778814","216108549156","216105169328","216106153051","216105315280","216109672092","216107274259","216100631415","216105577472","216101709208","216104718426","216101431358","216105983505","216109931304","216101016291","216101629305","216104974200","216109904456","216102173467","216102598446","216101445437","216107749785","216103788669","216101190195","216105731487","216100027288","216109022004","216101680334","216104344878","216100522611","216103769271","216103925856","216104482789","216102341325","216108089723","216109419427","216103486572","216106576858","216103205053","216107731882","216101767805","216109645247","216104214755","216108472309","216102976404","216101611794","216103983573","216106162070","216107216563","216102950107","216104073908","216109340261","216100570818","216105072452","216108270405","216103248549","216108656444","216102473295","216104152956","216107829913","216104448415","216107821737","216103345071","216108349563","216107524631","216106944953","216102157705","216100722202","216101858329","216107991451","216106524165","216100041356","216107671692","216109537686","216104979985","216102154572","216107850263","216103445354","216103527918","216108027445","216104466769","216103099957","216105872904","216104664393","216107620978","216106941485","216101887109","216102776403","216106550265","216102368706","216102923465","216102883642","216105946003","216100597452","216104185486","216103593607","216107771510","216103264476","216109679076","216101869916","216102879654","216100593246","216100016382","216104920293","216106174102","216104328229","216104756988","216100055040","216103781319","216107536108","216104322477","216106720647","216100041232","216108094265","216101734873","216100710605","216107069363","216109439148","216104383840","216102170748","216104495002","216102162224","216109656165","216104211279","216108461038","216103735415","216100179321","216102338565","216109290426","216101134064","216106132716","216101052254","216107275273","216101660450","216106053120","216103544641","216109613974","216103322003","216106169361","216104284005","216109327141","216100850532","216102094782","216104649253","216105646933","216102708005","216107587088","216107045992","216100078223","216104326913","216100423126","216101519241","216100126363","216106847679","216106595156","216105380266","216102498673","216102125298","216108387831","216102584532","216104065784","216104086529","216100311830","216108415014","216105300956","216103166025","216108429952","216106268892","216105298554","216104526908","216101266220","216106779061","216104143422","216101136277","216106823998","216103854797","216101305973","216109676291","216101912793","216100121755","216101676732","216109671961","216108066186","216106824974","216108139033","216108305229","216108536310","216109861563","216103316650","216106126636","216107214109","216100580464","216105959250","216103104867","216100780320","216103165839","216101011530","216104671646","216107923982","216102137607","216107387214","216109080841","216102212336","216103443141","216100975487","216103877293","216105657648","216107333256","216103385683","216106569837","216101708087","216103224111","216105170518","216101072474","216107442102","216102279865","216107648914","216107167931","216109467325","216107138580","216100574988","216107057564","216102710972","216102324837","216109950401","216101975725","216103482263","216100568768","216100325915","216101482611","216109254159","216103500663","216109520400","216104688621","216104690980","216107830022","216102289279","216107555110","216104168562","216101303842","216104705067","216103424605","216108308424","216101621159","216105312283","216101702749","216106046539","216101090683","216109424863","216105019239","216108868424","216109634018","216105488990","216109125949","216109634665","216104080463","216102768741","216102118806","216107075126","216104081193","216104387265","216105749252","216106948256","216100489130","216103411541","216104717262","216107114886","216102281611","216103921485","216105288493","216107385739","216106341336","216104602746","216107865510","216107038170","216102222195","216104941555","216104379435","216101975796","216100195158","216108982467","216106151496","216109803199","216104522333","216103311753","216103459248","216102386780","216100118150","216105276758","216102828066","216100471836","216109734326","216102571019","216104322246","216109835614","216105884770","216101099251","216102569504","216103408363","216105033210","216105452208","216103371353","216108432196","216108495423","216106678521","216100570769","216101163390","216107615481","216107457081","216108293596","216103647469","216105312548","216105088790","216107200208","216100316514","216103327564","216103492485","216103892460","216106238019","216108711658","216107402632","216104998026","216102267256","216108702378","216104446485","216101447717","216104179881","216108514695","216109189438","216102938588","216105379239","216105722302","216107372673","216106646565","216103551467","216101221380","216107681739","216109690094","216108149386","216100579421","216104871939","216108321723","216102313593","216105307571","216100206031","216105658967","216109194942","216100711583","216109705463","216100765314","216106344251","216108383383","216107317610","216102084225","216101566318","216103954542","216106289568","216104291456","216103531683","216100969850","216107748029","216107976177","216103360122","216103538026","216104885605","216101428736","216108545489","216106302702","216102800536","216109350705","216101072494","216101288638","216104449427","216105324637","216100230111","216101596788","216100580267","216107920966","216102813098","216108080139","216106652798","216102276279","216103658478","216106345628","216100448488","216100179133","216106181627","216106977382","216104411819","216104723745","216107310170","216100854527","216107442951","216106807298","216108540682","216100174584","216109103015","216109892310","216102996797","216101652285","216108363320","216106362951","216108815954","216108804525","216106014173","216104051235","216106330178","216102356828","216103354994","216102379010","216107377573","216106292096","216100856185","216102019836","216103059241","216101667127","216105208113","216100575672","216108222006","216107172036","216104224275","216101261702","216109059021","216106447756","216100831975","216106644786","216100563894","216106984636","216107633567","216105159331","216107539823","216100717831","216108290673","216104288270","216103824508","216106431504","216104685168","216102830916","216104669299","216107115822","216105675165","216102221565","216103414671","216100230109","216101572098","216109581608","216102114480","216103689572","216109382275","216107927178","216107940772","216105823785","216105856752","216106491311","216106655880","216108339996","216108256149","216106807658","216103001973","216104203344","216102123059","216100759267","216100980611","216107973746","216108216974","216105913042","216108408302","216104814353","216105000821","216104756738","216103983544","216102758870","216103475953","216108552603","216106074581","216101253494","216101006483","216108072507","216101948806","216109338617","216100577196","216100065746","216101085791","216103768997","216102662242","216103453422","216103416652","216106987632","216109675184","216101395216","216106333491","216105198018","216103084868","216109643232","216104009134","216107985573","216109835436","216101918993","216105758913","216108753827","216105590602","216108994811","216107073215","216104711736","216109997540","216101100986","216105021433","216100051257","216101850208","216108212184","216108025420","216106043452","216100169018","216101135645","216105455198","216103000258","216100528727","216103664990","216100003587","216109220366","216108432037","216102530625","216109090793","216109273909","216100642800","216103779290","216101452639","216105484614","216101514630","216103782092","216103245812","216105770886","216100160756","216105177796","216103914607","216102596864","216100331115","216102504361","216105488799","216106719360","216107610903","216103767287","216109619768","216107683309","216102223963","216105132272","216104517281","216101833723","216108330184","216105421655","216103596306","216101417961","216107800005","216103373230","216102166217","216105811669","216108417691","216102872877","216104971980","216102760163","216104059720","216101587696","216108407291","216108481585","216109667980","216109994809","216106407068","216108929110","216103331196","216109727209","216108227066","216100853700","216107933941","216106303112","216100977517","216106303014","216108475857","216100766324","216102908734","216109869776","216101558751","216106110776","216107449585","216107137899","216104561921","216102104766","216101307760","216103671996","216103508336","216109060127","216108536515","216103776154","216100489820","216100122468","216103089576","216104631467","216109128738","216105891277","216102968782","216109751314","216107879639","216107339200","216106177827","216101826738","216108818843","216106103084","216104664899","216102321860","216103056873","216109673182","216107812326","216107593181","216103560986","216106896667","216104985158","216104170389","216105642570","216108770734","216109519510","216107715606","216107161641","216109024608","216102196110","216107302711","216102868435","216106608776","216102792484","216109440852","216100099578","216103950456","216103734354","216108277799","216102486246","216103763586","216109283655","216102092393","216108651806","216104417577","216108660355","216105081679","216100591457","216101679706","216105602854","216106086512","216107860726","216101943964","216106200385","216108979623","216101078431","216104248814","216101371396","216106187955","216105366925","216109949041","216107846844","216105552398","216106014359","216105730983","216109254778","216109121144","216108221030","216104011123","216107116395","216108328655","216106530629","216108641037","216100693554","216102200951","216107251464","216100410705","216107751925","216106360181","216106624091","216105611840","216104555369","216106385073","216109389894","216105538164","216109065706","216108600994","216100190078","216102600275","216102695175","216108395745","216103236784","216106076201","216101194953","216108787121","216102971922","216106057415","216108952515","216107748402","216103223049","216100765041","216107156144","216105773597","216105495929","216104450233","216107538101","216109208718","216105788285","216103675267","216106243251","216100817531","216105755501","216103973672","216107513974","216101974126","216104778804","216108176499","216102615351","216103143855","216106219776","216109424896","216105971066","216104499908","216102536717","216103298781","216102088038","216100161788","216106586935","216104409998","216103179941","216103709835","216106444193","216100248757","216101015121","216105646216","216105384666","216109471408","216108446312","216101391184","216108869790","216101599492","216109754541","216101175158","216104789844","216106359792","216100350865","216103404040","216106698348","216109733012","216104026007","216100888876","216100135150","216105495166","216104247884","216106913406","216106426931","216108839292","216103296696","216101085450","216103613062","216104993473","216101095837","216102867330","216107346468","216107886443","216104600142","216108234531","216106903630","216106846688","216106173922","216101773019","216108510943","216103089603","216103585910","216104431769","216104138099","216105283657","216106737851","216101983763","216108985210","216107027333","216107372322","216106295993","216105458419","216109359008","216105654139","216100809911","216103411990","216109562010","216107577030","216103706033","216101374810","216103747375","216101841196","216103358979","216100604593","216106140022","216101147713","216105425599","216108332754","216101802383","216104996863","216105231858","216104781451","216100785809","216105230032","216105023185","216104793387","216107369243","216100925893","216108962513","216108423698","216102795917","216103966557","216101715938","216104955022","216107886835","216104511563","216107619659","216105745146","216107295787","216108691826","216100892441","216102135207","216106482854","216100601201","216104657082","216107382836","216109218402","216103815369","216103821864","216102192926","216107970959","216109600395","216105233708","216109795457","216107241468","216102072022","216105460816","216102037322","216108750203","216102390854","216106771236","216102729448","216106267777","216109936318","216107834815","216107167247","216101018982","216108909915","216109650190","216107334757","216107679915","216102482175","216106781341","216100748649","216105900337","216105432552","216104552046","216107016921","216109496025","216108918235","216105690774","216101905448","216100092275","216100728342","216105920336","216109448456","216100119727","216102794504","216100918744","216105035583","216108679147","216109988324","216109002285","216101527105","216100740241","216101419186","216102516824","216101582698","216106023928","216103206236","216103935661","216101009282","216102332047","216105134659","216108060494"};
        return new HashSet<String>(Arrays.asList(usedDataCodeArr));
    }

    /**
     *  Function sinh ra danh sách Data Code theo params.
     * @param yearCode          Prefix 3 ký tự đầu của năm trong mỗi Data Code
     * @param unitPriceCode         Prefix 2 ký tự tiếp theo của mệnh giá gói trong mỗi Data Code
     * @param numberOfCode      Số lượng Data Code cần sinh ra
     * @return
     */
    public static HashSet<String> generateDataCodeList(String yearCode, String unitPriceCode, Integer numberOfCode){
        if(Config.getInstance().getProperty("redis.turn_on").equals("false")){
            DataCode dataCode = new DataCode();
            dataCode.setKeyByYear(yearCode);
            dataCode.setHasKeyByUnitPrice(unitPriceCode);
            dataCode.setDataCodeHashSet(getUsedDataCodeHashSet());
            return dataCode.getDataCodeHashSet();
        }else{
            RedisTemplate<String, String> redisTemplate = (RedisTemplate<String, String>) AppContext.getApplicationContext().getBean("redisTemplate");
            DataCode dataCodeForUsedFixedValition = (DataCode)redisTemplate.opsForHash().get(Constants.KEY_USED_2016, Constants.HAS_KEY_USED_2016UNIT_PRICE_10);
            DataCode dataCodeForYearAndUnitPriceValidation = (DataCode)redisTemplate.opsForHash().get(yearCode, "10");

            if(dataCodeForYearAndUnitPriceValidation == null){
                dataCodeForYearAndUnitPriceValidation = new DataCode();
            }

            duplicatedList = new ArrayList<String>();
            HashSet<String> newGeneratedDataCodeHashSet = new HashSet<String>();
            System.out.println("Generating Data Code (tu 1 den " + numberOfCode + ")...");
            int counter = 0;
            int addedCounter = 0;
            while (addedCounter < numberOfCode){
                ++counter;
                tmpDataCode = new StringBuilder();
                tmpDataCode.append(yearCode)
                        .append(unitPriceCode)
                        .append(randomSevenDigits());
                if(newGeneratedDataCodeHashSet.contains(tmpDataCode.toString())
                        || dataCodeForUsedFixedValition.getDataCodeHashSet().contains(tmpDataCode.toString())
                        || dataCodeForYearAndUnitPriceValidation.getDataCodeHashSet().contains(tmpDataCode.toString())){
                    duplicatedList.add(tmpDataCode.toString());
                }else{
                    addedCounter++;
                    newGeneratedDataCodeHashSet.add(tmpDataCode.toString());
                    if(showCounter){
                        System.out.println(addedCounter + "       :       " +tmpDataCode.toString());
                    }else{
                        System.out.println(tmpDataCode.toString());
                    }
                }
            }
            System.out.println("========================");
            System.out.println("Finished");
            System.out.println("Tong so lan chay: " + counter + " lan");
            System.out.println("Total Data Code duoc sinh ra: " + newGeneratedDataCodeHashSet.size() + " data codes");
            System.out.println("========================");
            if(duplicatedList.size() > 0){
                System.out.println("Tong so ma Data Code bi trung: " + duplicatedList.size() + " Data Code");
                System.out.println("Danh sach trung ma Data Code (Khong su dung danh sach nay!)");
                for (String dupDataCode : duplicatedList){
                    System.out.println(dupDataCode);
                }
            }else{
                System.out.println("Khong co Data Code bi trung!");
            }
            return newGeneratedDataCodeHashSet;
        }
    }

    /**
     * Store Data Code list to Redis with KEY (region) is Year number and Hash Key (Object Key) is Unit Price value to check later.
     * @param dataCode      Object that includes DataCode list for a specific Order.
     */
    public static void storeDataCodes(DataCode dataCode){
        RedisTemplate<String, String> redisTemplate = (RedisTemplate<String, String>) AppContext.getApplicationContext().getBean("redisTemplate");
        redisTemplate.opsForHash().put(dataCode.getKey(), dataCode.getHashKey(), dataCode);
    }

    /**
     * Sinh ra 1 chuỗi số theo độ dài của chuỗi quy định là 12 ký tự.
     * @return
     */
    private static String randomSevenDigits(){
        dataCodeSuffix = new StringBuilder(String.valueOf((int)(Math.random() * ((max - min) + 1)) + min));
        if(dataCodeSuffix.toString().length() < total_length - prefix_year - prefix_unit_price){
            if(dataCodeSuffix.toString().length() == 6){
                dataCodeSuffix = new StringBuilder("0").append(dataCodeSuffix.toString());
            }else if(dataCodeSuffix.toString().length() == 5){
                dataCodeSuffix = new StringBuilder("00").append(dataCodeSuffix.toString());
            }else if(dataCodeSuffix.toString().length() == 4){
                dataCodeSuffix = new StringBuilder("000").append(dataCodeSuffix.toString());
            }else if(dataCodeSuffix.toString().length() == 3){
                dataCodeSuffix = new StringBuilder("0000").append(dataCodeSuffix.toString());
            }else if(dataCodeSuffix.toString().length() == 2){
                dataCodeSuffix = new StringBuilder("00000").append(dataCodeSuffix.toString());
            }else if(dataCodeSuffix.toString().length() == 1){
                dataCodeSuffix = new StringBuilder("000000").append(dataCodeSuffix.toString());
            }
        }
        return dataCodeSuffix.toString();
    }
}
